.container
  .row.task-index-header
    %h1
      Care tasks for
      =best_in_place @group, :name
      %span.edit-indicator.glyphicon.glyphicon-pencil
    =link_to new_group_task_path(current_user.group) do
      .purple-new-task-button
        %h4 Add New Task
  .row
    %ul.nav.nav-tabs
      %li
        %a.my-task-count{'data-toggle' => "tab", href: "#mytasks"}
          My Tasks
          ="(#{@my_tasks.count})"
      %li
        %a{'data-toggle' => "tab", href: "#alltasks"}
          All Upcoming Tasks
          ="(#{@tasks.count})"
      %li
        %a.open-task-count{'data-toggle' => "tab", href: "#opentasks"}
          Open Tasks
          ="(#{@open_tasks.count})"

    .tab-content
      #mytasks.tab-pane.fade
        -unless @my_tasks.empty?
          -@my_tasks.sort_by(&:task_date).each do |task|
            =render 'task', task: task, group: @group
        -else
          =render 'tasks/no_tasks'

      #alltasks.tab-pane.fade
        -@tasks.sort_by(&:task_date).each do |task|
          =render 'all_task', task: task, group: @group

      #opentasks.tab-pane.fade
        -unless @open_tasks.empty?
          -@open_tasks.sort_by(&:task_date).each do |task|
            =render 'all_task', task: task, group: @group
        -else
          =render 'tasks/no_group_tasks'

.first-time-user
  %h1 Hello First Timer!
  =link_to "Dismiss", root_path, {class: "dismiss"}

:javascript
  $(document).ready(function () {

    //first time user
    if (#{current_user.sign_in_count} == 1) {
      //the JS below will make it ALWAYS show - need logic to only have it show 1x.
      // $('.first-time-user').show();
    }

    $('dismiss').on('click', function() {
      $('first-time-user').hide();
    });
    //second-time user

    if (#{@my_tasks.count} < 1) {
      $('.nav-tabs li:last').addClass('active');
      $('#opentasks').addClass('in active');
    }
    else {
      $('.nav-tabs li:first').addClass('active');
      $('#mytasks').addClass('in active');
    }
  });